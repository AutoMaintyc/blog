---
layout: post
title:  "帧同步"
date:   2025-07-06 12:40:39 +0800
permalink: /帧同步/
parent: 网络
nav_order: 3
---

# 什么是帧同步
低频指令同步 + 多端确定性计算  
同步每个客户端的操作，服务器对这些操作进行转发，客户端再根据这些操作来计算  

所有客户端执行相同的操作指令序列，基于相同的初始状态和逻辑帧率进行确定性计算，确保结果一致。  
服务器仅转发操作指令（如移动、技能释放），不参与逻辑计算  
# 解构的结果
操作  
同步  

# 要求
​​确定性计算​​：避免浮点数误差  
一致随机种子​​：所有客户端使用相同随机数序列  
​​逻辑与表现分离​​：逻辑层用定点数计算，表现层用浮点数插值渲染  

# 实现
基于UDP  
## 服务器
搜集客户端指令并广播  
每​​N个逻辑帧广播一次  
## 客户端
根据服务器发来的指令进行计算  
时序一致，即同步在某帧的操作  
用稳定低频的逻辑帧驱动高帧率渲染  
累计N帧的操作后批量执行，避免因单帧丢包导致卡顿  

# 优化
冗余发包​​：每个数据包携带前n帧的操作，对抗丢包  
动态缓冲​：根据网络抖动动态调整逻辑帧执行节奏，缓存多帧数据平滑延迟波动  